ALTER TABLE `games` DROP FOREIGN KEY `fk_games_simulations`;

ALTER TABLE `load_functions` DROP FOREIGN KEY `fk_load_functions_service_providers`;

ALTER TABLE `network_owners` DROP FOREIGN KEY `fk_network_owners_simulations`;

ALTER TABLE `service_providers` DROP FOREIGN KEY `fk_service_providers_simulations`;

ALTER TABLE `service_providers_load_functions` DROP FOREIGN KEY `fk_service_providers_load_function_load_functions`;
ALTER TABLE `service_providers_load_functions` DROP FOREIGN KEY `fk_service_providers_load_functions_service_providers`;

ALTER TABLE `service_providers_games` DROP FOREIGN KEY `fk_service_providers_games_games`;
ALTER TABLE `service_providers_games` DROP FOREIGN KEY `fk_service_providers_games_load_function`;
ALTER TABLE `service_providers_games` DROP FOREIGN KEY `fk_service_providers_games_service_providers`;

ALTER TABLE `network_owners_games` DROP FOREIGN KEY `fk_network_owners_games_games`;
ALTER TABLE `network_owners_games` DROP FOREIGN KEY `fk_network_owners_games_network_owners`;


TRUNCATE TABLE `service_providers_games`;
TRUNCATE TABLE `network_owners_games`;
TRUNCATE TABLE `service_providers_load_functions`;
TRUNCATE TABLE `load_functions`;
TRUNCATE TABLE `service_providers`;
TRUNCATE TABLE `network_owners`;
TRUNCATE TABLE `games`;
TRUNCATE TABLE `simulations`;



ALTER TABLE `games` ADD CONSTRAINT `fk_games_simulations` FOREIGN KEY (`simulation_id`) REFERENCES `simulations` (`id`) ON DELETE SET NULL ON UPDATE CASCADE;

ALTER TABLE `load_functions` ADD CONSTRAINT `fk_load_functions_service_providers` FOREIGN KEY (`service_provider_id`) REFERENCES `service_providers` (`id`);

ALTER TABLE `network_owners` ADD CONSTRAINT `fk_network_owners_simulations` FOREIGN KEY (`simulation_id`) REFERENCES `simulations` (`id`) ON DELETE SET NULL ON UPDATE CASCADE;

ALTER TABLE `service_providers` ADD CONSTRAINT `fk_service_providers_simulations` FOREIGN KEY (`simulation_id`) REFERENCES `simulations` (`id`) ON DELETE SET NULL ON UPDATE CASCADE;

ALTER TABLE `service_providers_load_functions` ADD CONSTRAINT `fk_service_providers_load_function_load_functions` FOREIGN KEY (`function_id`) REFERENCES `load_functions` (`id`);
ALTER TABLE `service_providers_load_functions` ADD CONSTRAINT `fk_service_providers_load_functions_service_providers` FOREIGN KEY (`service_provider_id`) REFERENCES `service_providers` (`id`);

ALTER TABLE `service_providers_games` ADD CONSTRAINT `fk_service_providers_games_games` FOREIGN KEY (`game_id`) REFERENCES `games` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `service_providers_games` ADD CONSTRAINT `fk_service_providers_games_load_function` FOREIGN KEY (`load_function_id`) REFERENCES `load_functions` (`id`);
ALTER TABLE `service_providers_games` ADD CONSTRAINT `fk_service_providers_games_service_providers` FOREIGN KEY (`service_provider_id`) REFERENCES `service_providers` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE `network_owners_games` ADD CONSTRAINT `fk_network_owners_games_games` FOREIGN KEY (`game_id`) REFERENCES `games` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `network_owners_games` ADD CONSTRAINT `fk_network_owners_games_network_owners` FOREIGN KEY (`network_owner_id`) REFERENCES `network_owners` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;





CREATE TABLE `games` (
  `id` int NOT NULL AUTO_INCREMENT,
  `simulation_id` int DEFAULT NULL,
  `max_cores_hosted` int DEFAULT NULL,
  `cpu_price` float DEFAULT NULL,
  `years` float DEFAULT NULL,
  `daily_timeslots` int DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id_UNIQUE` (`id`),
  KEY `fk_sim_id_idx` (`simulation_id`),
  CONSTRAINT `fk_games_simulations` FOREIGN KEY (`simulation_id`) REFERENCES `simulations` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=818 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='	';

CREATE TABLE `load_functions` (
  `id` int NOT NULL AUTO_INCREMENT,
  `service_provider_id` int NOT NULL,
  `sigma` float NOT NULL,
  `avg_load` float NOT NULL,
  `hyper_params_a_k` varchar(250) DEFAULT NULL,
  `hyper_params_t_k` varchar(250) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_load_functions_service_providers_idx` (`service_provider_id`),
  CONSTRAINT `fk_load_functions_service_providers` FOREIGN KEY (`service_provider_id`) REFERENCES `service_providers` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=276 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `network_owners` (
  `id` int NOT NULL AUTO_INCREMENT,
  `network_owner_name` varchar(45) DEFAULT NULL,
  `simulation_id` int DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id_UNIQUE` (`id`),
  KEY `fk_network_owners_simulations` (`simulation_id`),
  CONSTRAINT `fk_network_owners_simulations` FOREIGN KEY (`simulation_id`) REFERENCES `simulations` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=184 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `service_providers` (
  `id` int NOT NULL AUTO_INCREMENT,
  `service_provider_name` varchar(45) DEFAULT NULL,
  `simulation_id` int DEFAULT NULL,
  `benefit_factor_min` float DEFAULT NULL,
  `benefit_factor_max` float DEFAULT NULL,
  `chi_min` float DEFAULT NULL,
  `chi_max` float DEFAULT NULL,
  `avg_load_min` float DEFAULT NULL,
  `avg_load_max` float DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id_UNIQUE` (`id`),
  KEY `fk_service_providers_simulations` (`simulation_id`),
  CONSTRAINT `fk_service_providers_simulations` FOREIGN KEY (`simulation_id`) REFERENCES `simulations` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=539 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `service_providers_load_functions` (
  `service_provider_id` int NOT NULL,
  `function_id` int NOT NULL,
  `time` float NOT NULL,
  `value` float NOT NULL,
  KEY `fk_service_provider_load_function_load_function_idx` (`function_id`),
  KEY `fk_service_providers_load_functions_service_providers_idx` (`service_provider_id`),
  CONSTRAINT `fk_service_providers_load_function_load_functions` FOREIGN KEY (`function_id`) REFERENCES `load_functions` (`id`),
  CONSTRAINT `fk_service_providers_load_functions_service_providers` FOREIGN KEY (`service_provider_id`) REFERENCES `service_providers` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `service_providers_games` (
  `service_provider_id` int NOT NULL,
  `game_id` int NOT NULL,
  `benefit_factor` float DEFAULT NULL,
  `avg_load` float DEFAULT NULL,
  `chi` float DEFAULT NULL,
  `allocation` float DEFAULT NULL,
  `utilities` float DEFAULT NULL,
  `shapley_value` float DEFAULT NULL,
  `revenues` float DEFAULT NULL,
  `load_function_id` int DEFAULT NULL,
  PRIMARY KEY (`service_provider_id`,`game_id`),
  KEY `fk_service_providers_games_games` (`game_id`),
  KEY `fk_service_providers_games_load_function_idx` (`load_function_id`),
  CONSTRAINT `fk_service_providers_games_games` FOREIGN KEY (`game_id`) REFERENCES `games` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `fk_service_providers_games_load_function` FOREIGN KEY (`load_function_id`) REFERENCES `load_functions` (`id`),
  CONSTRAINT `fk_service_providers_games_service_providers` FOREIGN KEY (`service_provider_id`) REFERENCES `service_providers` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `network_owners_games` (
  `network_owner_id` int NOT NULL,
  `game_id` int NOT NULL,
  `shapley_value` float DEFAULT NULL,
  `revenues` float DEFAULT NULL,
  PRIMARY KEY (`network_owner_id`,`game_id`),
  KEY `fk_network_owners_games_games` (`game_id`),
  CONSTRAINT `fk_network_owners_games_games` FOREIGN KEY (`game_id`) REFERENCES `games` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `fk_network_owners_games_network_owners` FOREIGN KEY (`network_owner_id`) REFERENCES `network_owners` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `simulations` (
  `id` int NOT NULL AUTO_INCREMENT,
  `simulation_name` varchar(45) NOT NULL,
  `max_cores_hosted_min` int DEFAULT NULL,
  `max_cores_hosted_max` int DEFAULT NULL,
  `cpu_price_min` float DEFAULT NULL,
  `cpu_price_max` float DEFAULT NULL,
  `years_min` float DEFAULT NULL,
  `years_max` float DEFAULT NULL,
  `daily_timeslots_min` int DEFAULT NULL,
  `daily_timeslots_max` int DEFAULT NULL,
  `amount_of_players` int DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `simulation_name_UNIQUE` (`simulation_name`),
  UNIQUE KEY `id_UNIQUE` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=184 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
